
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    
      <title>IRB　それはRubyistの魔法のランプ</title>
    
    
    <meta name="author" content="kyoendo" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter-ext/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/assets/themes/twitter-ext/css/style.css?body=1" rel="stylesheet" type="text/css" media="all" />
    <link href="/assets/themes/twitter-ext/css/syntax.css" rel="stylesheet" type="text/css" />
    <link href="/assets/themes/twitter-ext/css/lightbox.css" rel="stylesheet" />
    <link media="only screen and (max-device-width: 480px)" href="/assets/themes/twitter-ext/css/iphone.css" type="text/css" rel="stylesheet" />
    <!--<link media="only screen and (device-width: 768px)" href="/assets/themes/twitter-ext/css/ipad.css" type="text/css" rel="stylesheet" />-->
    <!--<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />-->
    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico" />
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png" />-->
<!--<script type="text/x-mathjax-config">-->
  <!--MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ["\\(","\\)"]] } });-->
<!--</script>-->
<!--<script type="text/javascript"-->
  <!--src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">-->
<!--</script>-->
  </head>
  <body>
    <div id="fb-root"></div>

    <div class="navbar">
      <div class="navbar-inner">
        <div class="container">
          <a class="avatar" href="/">
            <img src="http://gravatar.com/avatar/97aa01a6f87da85251be77792dec1d9c?s=80" height="75" width="75" class="avatar" />
          </a>
          <a class="brand" href="/">hp12c</a>
          <div id='rss'>
            <a href="http://feeds.feedburner.com/github/melborne" title="Subscribe to my feed" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon32x32.png" alt="" style="border:0"/></a><a href="http://feeds.feedburner.com/github/melborne" title="Subscribe to my feed" rel="alternate" type="application/rss+xml"></a>
            <!--<a href="/atom.xml" id="rss">-->
              <!--<img src="/assets/images/site/rss.png" alt="rss" title="RSS" height="22" width="22" />-->
            <!--</a>-->
          </div>
          <ul class="nav">
            <li>
            <a class="books" href="/books/">Books</a>
            </li>
            <li>
              <a class="myproducts" href="http://welove.herokuapp.com/?keyword=merborne">Products</a>
            </li>
            
            
            


  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  

  
    
  

  
    
    	
      <li><a href="/tags.html">Tags</a></li>
    	
    
  








            <li class='site'>
              <a href="https://twitter.com/merborne" id="twitter">
                <img src="/assets/images/site/twitter.png" alt="twitter" title="@merborne on Twitter" height="32" width="32" />
              </a>
            </li>
            <li class='site'>
              <a href="https://github.com/melborne" id="github">
                <img src="/assets/images/site/github.png" alt="github" title="@melborne on GitHub" height="24" width="24" />
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container">

      <div class="content">
        
<div class="page-header span8">
  <div class="date"><span>16 November 2010</span></div>
  <h1 class='page-title'><a href="/2010/11/16/IRB-Rubyist">IRB　それはRubyistの魔法のランプ</a> <small>  </small></h1>
</div>

<div class="row">
  <div class="span9">
    <div class="ad" id="topAdsense">
      <script type="text/javascript"><!--
      google_ad_client = "ca-pub-8790567277062819";
      /* hp12c */
      google_ad_slot = "7055414638";
      google_ad_width = 728;
      google_ad_height = 90;
      //-->
      </script>
      <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script>
    </div>

    <pre><code>IRB　名前を聞けば誰でもわかる
超有名なライブラリ
IRBを知らなけりゃ　それはもぐりのRubyist

:$
IRB　全部のRubyに付いてくる
あなたとRubyの対話の窓口
できないことがあるのなら　irbと打ってみよう
rubyと打ってもダメですよ

IRB　それはRubyistの魔法のランプ
こすれば何かが現れる
IRB　それはRubyistの魔法のランプ
こすって願いを叶えよう
I RuB you　I RuB you
:TO

IRB　色気がないのはご愛嬌
色がいるなら　.irbrcしてください
補完だってインデントだって
そうしたいならプロンプトだって
あなた色に染まります

IRB　それでも不満があるのなら
wirble fancy_irbが色付けします
デバッグするならpp ap y g -d
table viewにq o c
エディタいるならie sketches使ってね
コマンド足すならbosonあるよ
全部入りならirbtools！

IRB　それはRubyistの魔法のランプ
こすれば何かが現れる
IRB　それはRubyistの魔法のランプ
こすって願いを叶えよう
I RuB you I RuB you

君がいなけりゃ生きてはいけない
君がいなけりゃRubyも要らない
君がいなけりゃ
プログラミングなんてもうやらない
ごめんなさい　いままでおざなりにして
これからはもっと君のこと大切にします

:D.S.

:CODA
IRB　それは
アイルランド共和同盟(Irish republican brotherhood)じゃない
IRB　それは
国際ラグビー評議会(International Rugby Board)でもない
IRB　もちろん
治験審査委員会(Institutional Review Board)でもない

IRB　そう　
それは　Interactive Rubyのこと
そう　それはRubyistの魔法のランプ
</code></pre>

<p>さて...</p>

<p>irbとその周辺のことを少し調べたので、ここにまとめておきます。</p>

<h2>irbの簡単な使い方</h2>

<p>ターミナル上でirbと打って、現れたプロンプトでRubyのコードを入力します。</p>

<div class="highlight"><pre><code class="bash"> %irb
 irb<span class="o">(</span>main<span class="o">)</span>:001:0&gt; puts <span class="s2">&quot;hello, irb!&quot;</span>
 hello, irb!
 <span class="o">=</span>&gt; nil
</code></pre></div>


<p>リターンで式の評価が行われ、結果が返されます。</p>

<p>複数行に渡る入力も受け付けます。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>main<span class="o">)</span>:004:0&gt; def fib n
 irb<span class="o">(</span>main<span class="o">)</span>:005:1&gt; <span class="o">[</span>0,1<span class="o">]</span>.include?<span class="o">(</span>n<span class="o">)</span> ? n : fib<span class="o">(</span>n-1<span class="o">)</span> + fib<span class="o">(</span>n-2<span class="o">)</span>
 irb<span class="o">(</span>main<span class="o">)</span>:006:1&gt; <span class="nv">end</span>
 <span class="o">=</span>&gt; nil
 irb<span class="o">(</span>main<span class="o">)</span>:007:0&gt; fib <span class="nv">10</span>
 <span class="o">=</span>&gt; 55
</code></pre></div>


<p>つまりリターン入力時に式が完了していない場合、評価を先送りして　完了した時結果を返します。</p>

<p>_(アンダースコア)は前の評価結果を保持します。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>main<span class="o">)</span>:008:0&gt; 1 + <span class="nv">2</span>
 <span class="o">=</span>&gt; 3
 irb<span class="o">(</span>main<span class="o">)</span>:009:0&gt; _ * <span class="nv">3</span>
 <span class="o">=</span>&gt; 9
 irb<span class="o">(</span>main<span class="o">)</span>:010:0&gt; _ / 2.0
 <span class="o">=</span>&gt; 4.5
</code></pre></div>


<p>mオプションを付ければ高度な数学電卓になります。つまりmathnをrequireします。</p>

<div class="highlight"><pre><code class="bash"> % irb -m     
 &gt;&gt; 1/2
 <span class="o">=</span>&gt; <span class="o">(</span>1/2<span class="o">)</span>
 &gt;&gt; Complex<span class="o">(</span>0, -1<span class="o">)</span>
 <span class="o">=</span>&gt; <span class="o">(</span>0-1i<span class="o">)</span>
 &gt;&gt; Prime.each<span class="o">(</span>100<span class="o">)</span> <span class="k">do</span> |pr|
 &gt;* print pr, <span class="s2">&quot; &quot;</span>
 &gt;&gt; end
 2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 <span class="nv">97</span> <span class="o">=</span>&gt; nil
</code></pre></div>


<p>rオプションでライブラリを読み込みます。</p>

<div class="highlight"><pre><code class="bash"> % irb -ropen-uri
 &gt;&gt; <span class="nv">site</span> <span class="o">=</span> open <span class="s2">&quot;http://www.nintendo.co.jp&quot;</span>
 <span class="o">=</span>&gt; <span class="c">#&lt;StringIO:0x76e0a8&gt;</span>
 &gt;&gt; site.read.scan<span class="o">(</span>/&lt;a href.*?&gt;/<span class="o">)</span>
 <span class="o">=</span>&gt; <span class="o">[</span><span class="s2">&quot;&lt;a href=&quot;</span>n00/index.html<span class="s2">&quot;&gt;&quot;</span>, <span class="s2">&quot;&lt;a href=&quot;</span>schedule/index.html<span class="s2">&quot;&gt;&quot;</span>, <span class="s2">&quot;&lt;a href=&quot;</span>wii/index.html<span class="s2">&quot;&gt;&quot;</span>, <span class="s2">&quot;&lt;a href=&quot;</span>ds/index.html<span class="s2">&quot;&gt;&quot;</span>, <span class="s2">&quot;&lt;a href=&quot;</span>n09/index.html<span class="s2">&quot;&gt;&quot;</span>, <span class="s2">&quot;&lt;a href=&quot;</span>n10/index.html<span class="s2">&quot;&gt;&quot;</span>, <span class="s2">&quot;&lt;a href=&quot;</span>corporate/index.html<span class="s2">&quot;&gt;&quot;</span>, <span class="s2">&quot;&lt;a href=&quot;</span>wii/index.html<span class="s2">&quot; class=&quot;</span>wiiLink<span class="s2">&quot;&gt;&quot;</span>...<span class="o">]</span>
</code></pre></div>


<h2>DBインタフェース</h2>

<p>データベースファイルを読み込めば、DBインタフェースになります。DBを定義したuser.rbにconsoleファイルでアクセスする例を示します。</p>

<p>user.rbを作ります。</p>

<div class="highlight"><pre><code class="ruby"> <span class="nb">require</span> <span class="s2">&quot;dm-core&quot;</span>
 <span class="nb">require</span> <span class="s2">&quot;dm-migrations&quot;</span>
 <span class="no">DataMapper</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="ss">:default</span><span class="p">,</span> <span class="s2">&quot;sqlite3://</span><span class="si">#{</span><span class="no">Dir</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s2">/user.db&quot;</span><span class="p">)</span>
 
 <span class="k">class</span> <span class="nc">User</span>
   <span class="kp">include</span> <span class="ss">DataMapper</span><span class="p">:</span><span class="ss">:Resource</span>
   <span class="n">property</span> <span class="ss">:id</span><span class="p">,</span> <span class="no">Serial</span>
   <span class="n">property</span> <span class="ss">:nickname</span><span class="p">,</span> <span class="nb">String</span>
   <span class="n">property</span> <span class="ss">:email</span><span class="p">,</span> <span class="nb">String</span>
 <span class="k">end</span>
 
 <span class="no">DataMapper</span><span class="o">.</span><span class="n">auto_upgrade!</span>
</code></pre></div>


<p>consoleファイルを作ります。</p>

<div class="highlight"><pre><code class="bash"> irb -r/path/to/the/user
</code></pre></div>


<p>実行権限を付与します。</p>

<div class="highlight"><pre><code class="bash"> chmod +x console
</code></pre></div>


<p>consoleを実行してUserDBにアクセスします。</p>

<div class="highlight"><pre><code class="bash"> % ./console
 &gt;&gt; User.create<span class="o">(</span>:nickname <span class="o">=</span>&gt; <span class="s1">&#39;Charlie&#39;</span>, :email <span class="o">=</span>&gt; <span class="s1">&#39;charlie@abc.com&#39;</span><span class="o">)</span>
 <span class="o">=</span>&gt; <span class="c">#&lt;User @id=1 @nickname=&quot;Charlie&quot; @email=&quot;charlie@abc.com&quot;&gt;</span>
 &gt;&gt; User.create<span class="o">(</span>:nickname <span class="o">=</span>&gt; <span class="s1">&#39;Tommy&#39;</span>, :email <span class="o">=</span>&gt; <span class="s1">&#39;tommy@abc.com&#39;</span><span class="o">)</span>
 <span class="o">=</span>&gt; <span class="c">#&lt;User @id=2 @nickname=&quot;Tommy&quot; @email=&quot;tommy@abc.com&quot;&gt;</span>
 &gt;&gt; User.all
 <span class="o">=</span>&gt; <span class="o">[</span><span class="c">#&lt;User @id=1 @nickname=&quot;Charlie&quot; @email=&quot;charlie@abc.com&quot;&gt;, #&lt;User @id=2 @nickname=&quot;Tommy&quot; @email=&quot;tommy@abc.com&quot;&gt;]</span>
 &gt;&gt; User.first.nickname
 <span class="o">=</span>&gt; <span class="s2">&quot;Charlie&quot;</span>
</code></pre></div>


<h2>セッション</h2>

<p>irb上でirbコマンドを使うことで、別のセッションを立上げることができます。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>main<span class="o">)</span>:009:0&gt; irb
 irb#1<span class="o">(</span>main<span class="o">)</span>:001:0&gt; 1 + <span class="nv">2</span>
 <span class="o">=</span>&gt; 3
</code></pre></div>


<p>プロンプトの#番号が目印です。</p>

<p>mainのコンテキストで定義したメソッドは、Objectクラスのprivateインスタンスメソッドですから、どこからでも呼ぶことができます。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>main<span class="o">)</span>:025:0&gt; Object.private_instance_methods<span class="o">(</span><span class="nb">false</span><span class="o">)</span>.grep<span class="o">(</span>/^f/<span class="o">)</span>
 <span class="o">=</span>&gt; <span class="o">[</span>:fib<span class="o">]</span>
 
 irb<span class="o">(</span>main<span class="o">)</span>:007:0&gt; irb
 irb#1<span class="o">(</span>main<span class="o">)</span>:001:0&gt; fib <span class="nv">10</span>
 <span class="o">=</span>&gt; 55
</code></pre></div>


<p>しかしセッションはローカル変数を共有しません。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>main<span class="o">)</span>:001:0&gt; @a <span class="o">=</span> <span class="nv">1</span>
 <span class="o">=</span>&gt; 1
 irb<span class="o">(</span>main<span class="o">)</span>:002:0&gt; <span class="nv">b</span> <span class="o">=</span> <span class="nv">2</span>
 <span class="o">=</span>&gt; 2
 irb<span class="o">(</span>main<span class="o">)</span>:003:0&gt; irb
 irb#1<span class="o">(</span>main<span class="o">)</span>:001:0&gt; @a
 <span class="o">=</span>&gt; 1
 irb#1<span class="o">(</span>main<span class="o">)</span>:002:0&gt; b
 NameError: undefined <span class="nb">local </span>variable or method <span class="sb">`</span>b<span class="err">&#39;</span> <span class="k">for </span>main:Object from <span class="o">(</span>irb#1<span class="o">)</span>:2
</code></pre></div>


<p>irbコマンドに任意のコンテキストを渡せば、そのコンテキストでセッションが立ち上がります。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>main<span class="o">)</span>:011:0&gt; irb String
 irb#2<span class="o">(</span>String<span class="o">)</span>:001:0&gt; def too_long?
 irb#2<span class="o">(</span>String<span class="o">)</span>:002:1&gt;   self.size &gt; 10 ? <span class="s1">&#39;Yes, Too Long!!&#39;</span> : <span class="s1">&#39;No problem.&#39;</span>
 irb#2<span class="o">(</span>String<span class="o">)</span>:003:1&gt; <span class="nv">end</span>
 <span class="o">=</span>&gt; nil
 irb#2<span class="o">(</span>String<span class="o">)</span>:004:1&gt; <span class="nb">exit</span>
<span class="nb"> </span>irb<span class="o">(</span>main<span class="o">)</span>:012:0&gt; <span class="s2">&quot;Hello, Ruby World!!&quot;</span>.too_long?
 <span class="o">=</span>&gt; <span class="s2">&quot;Yes, Too Long!!&quot;</span>
 irb<span class="o">(</span>main<span class="o">)</span>:013:0&gt; <span class="s2">&quot;hi, ruby&quot;</span>.too_long?
 <span class="o">=</span>&gt; <span class="s2">&quot;No problem.&quot;</span>
 irb<span class="o">(</span>main<span class="o">)</span>:014:0&gt; 
</code></pre></div>


<p>セッションの一覧はjobs、切換えはfgコマンドで行います。</p>

<div class="highlight"><pre><code class="bash"> irb#2<span class="o">(</span>String<span class="o">)</span>:004:0&gt; <span class="nb">jobs</span>
 <span class="o">=</span>&gt; <span class="c">#0-&gt;irb on main (#&lt;Thread:0x0bfa68&gt;: stop)</span>
 <span class="c">#1-&gt;irb#1 on main (#&lt;Thread:0x09c57c&gt;: stop)</span>
 <span class="c">#2-&gt;irb#2 on String (#&lt;Thread:0x5d41e8&gt;: running)</span>
 irb#2<span class="o">(</span>String<span class="o">)</span>:005:0&gt; <span class="nb">fg </span><span class="nv">0</span>
 <span class="o">=</span>&gt; <span class="c">#&lt;IRB::Irb: @context=#&lt;IRB::Context:0x3df2fc&gt;, @signal_status=:IN_EVAL, @scanner=#&lt;RubyLex:0x3e5cd8&gt;&gt;</span>
 irb<span class="o">(</span>main<span class="o">)</span>:015:0&gt; 
</code></pre></div>


<p>セッションの終了はexitまたは、kill [セッション番号]で行います。</p>

<h2>Workspace</h2>

<p>コンテキストを共有するworkspaceというものもあります。pushb(現在のbindingをpushする)コマンドで、別のworkspaceに移動します。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>main<span class="o">)</span>:011:0&gt; <span class="nv">str</span> <span class="o">=</span> <span class="s2">&quot;hello, ruby&quot;</span>
 <span class="o">=</span>&gt; <span class="s2">&quot;hello, ruby&quot;</span>
 irb<span class="o">(</span>main<span class="o">)</span>:012:0&gt; pushb <span class="nv">str</span>
 <span class="o">=</span>&gt; <span class="o">[</span>main<span class="o">]</span>
 irb<span class="o">(</span>hello, ruby<span class="o">)</span>:013:0&gt; reverse!
 <span class="o">=</span>&gt; <span class="s2">&quot;ybur ,olleh&quot;</span>
</code></pre></div>


<p>そしてpopb(bindingをpop)で元のworkspaceに戻ります。popによって今いたworkspaceはなくなります。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>ybur ,olleh<span class="o">)</span>:014:0&gt; <span class="nv">popb</span>
 <span class="o">=</span>&gt; <span class="o">[]</span>
 irb<span class="o">(</span>main<span class="o">)</span>:015:0&gt; <span class="nv">str</span>
 <span class="o">=</span>&gt; <span class="s2">&quot;ybur ,olleh&quot;</span>
</code></pre></div>


<p>セッションと異なり別のworkspaceに移るときには、新たなコンテキストを常に引数として渡す必要があります。プロンプトの表示がworkspaceでも目印になります。</p>

<p>workspaceでは外側のローカル変数を共有します<sup id='fnref:1'><a href='#fn:1' rel='footnote'>1</a></sup>。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>main<span class="o">)</span>:016:0&gt; <span class="nv">str2</span> <span class="o">=</span> <span class="s2">&quot; world!!&quot;</span>
 <span class="o">=</span>&gt; <span class="s2">&quot; world!!&quot;</span>
 irb<span class="o">(</span>main<span class="o">)</span>:017:0&gt; pushb <span class="nv">str</span>
 <span class="o">=</span>&gt; <span class="o">[</span>main<span class="o">]</span>
 irb<span class="o">(</span>ybur ,olleh<span class="o">)</span>:018:0&gt; <span class="nv">str2</span>
 <span class="o">=</span>&gt; <span class="s2">&quot; world!!&quot;</span>
 irb<span class="o">(</span>ybur ,olleh<span class="o">)</span>:019:0&gt; concat <span class="nv">str2</span>
 <span class="o">=</span>&gt; <span class="s2">&quot;ybur ,olleh world!!&quot;</span>
 irb<span class="o">(</span>ybur ,olleh world!!<span class="o">)</span>:020:0&gt; <span class="nv">popb</span>
 <span class="o">=</span>&gt; <span class="o">[]</span>
 irb<span class="o">(</span>main<span class="o">)</span>:021:0&gt; <span class="nv">str</span>
 <span class="o">=</span>&gt; <span class="s2">&quot;ybur ,olleh world!!&quot;</span>
</code></pre></div>


<p>workspaceはスタックになっているので、セッションのようにジャンプして移動することができません。workspaceの使い道はよくわかりません。</p>

<h2>HELP</h2>

<p>Ruby Reference Manualを読みたいのならhelpします。空リターンで終了です。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>main<span class="o">)</span>:008:0&gt; <span class="nb">help</span>
<span class="nb"> </span>
<span class="nb"> </span>Enter the method name you want to look up.
 You can use tab to autocomplete.
 Enter a blank line to exit.
 
 &gt;&gt; String#reverse
 String#reverse
 
 <span class="o">(</span>from ruby core<span class="o">)</span>
 ---------------------------------------------
   str.reverse   -&gt; new_str
 ---------------------------------------------
 Returns a new string with the characters from str in reverse order.
 
   <span class="s2">&quot;stressed&quot;</span>.reverse   <span class="c">#=&gt; &quot;desserts&quot;</span>
 
 &gt;&gt; Array#join
 Array#join
 
 <span class="o">(</span>from ruby core<span class="o">)</span>
 ---------------------------------------------
   ary.join<span class="o">(</span><span class="nv">sep</span><span class="o">=</span><span class="nv">$,</span><span class="o">)</span>    -&gt; str
 ---------------------------------------------
 Returns a string created by converting each element of the array to a string,
 separated by sep.
 
   <span class="o">[</span> <span class="s2">&quot;a&quot;</span>, <span class="s2">&quot;b&quot;</span>, <span class="s2">&quot;c&quot;</span> <span class="o">]</span>.join        <span class="c">#=&gt; &quot;abc&quot;</span>
   <span class="o">[</span> <span class="s2">&quot;a&quot;</span>, <span class="s2">&quot;b&quot;</span>, <span class="s2">&quot;c&quot;</span> <span class="o">]</span>.join<span class="o">(</span><span class="s2">&quot;-&quot;</span><span class="o">)</span>   <span class="c">#=&gt; &quot;a-b-c&quot;</span>
 
 &gt;&gt; 
 <span class="o">=</span>&gt; nil
 irb<span class="o">(</span>main<span class="o">)</span>:009:0&gt; 
</code></pre></div>


<h2>.irbrcによるカスタマイズ</h2>

<p>ホームディレクトリに配置した.irbrcに、設定を記述してIRBをカスタマイズできます。</p>

<div class="highlight"><pre><code class="ruby"> <span class="nb">require</span> <span class="s2">&quot;irb/completion&quot;</span>
</code></pre></div>


<p>これでタブ補完が効くようになります。</p>

<div class="highlight"><pre><code class="ruby"> <span class="nb">require</span> <span class="s2">&quot;irb/ext/save-history&quot;</span>
 <span class="no">IRB</span><span class="o">.</span><span class="n">conf</span><span class="o">[</span><span class="ss">:SAVE_HISTORY</span><span class="o">]</span> <span class="o">=</span> <span class="mi">1000</span>
</code></pre></div>


<p>これで入力コマンドの履歴が1000件分保存されます。保存先はデフォルトでホームディレクトリの.irb_historyです。Ctrl+P Ctrl+N で履歴を辿ります。</p>

<div class="highlight"><pre><code class="ruby"> <span class="no">IRB</span><span class="o">.</span><span class="n">conf</span><span class="o">[</span><span class="ss">:EVAL_HISTORY</span><span class="o">]</span> <span class="o">=</span> <span class="mi">100</span>
</code></pre></div>


<p>これで実行結果の履歴を100件分覚えます。</p>

<p><strong>(アンダースコア2つ)で一覧し、</strong>[line_no]で取り出します。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>main<span class="o">)</span>:001:0&gt; 1 + <span class="nv">2</span>
 <span class="o">=</span>&gt; 3
 irb<span class="o">(</span>main<span class="o">)</span>:002:0&gt; _ * <span class="nv">4</span>
 <span class="o">=</span>&gt; 12
 irb<span class="o">(</span>main<span class="o">)</span>:003:0&gt; _ / <span class="nv">3</span>
 <span class="o">=</span>&gt; 4
 irb<span class="o">(</span>main<span class="o">)</span>:004:0&gt; __  &lt;-- 結果の一覧表示
 <span class="o">=</span>&gt; 1 3
 2 12
 3 4
 irb<span class="o">(</span>main<span class="o">)</span>:005:0&gt; <span class="nv">x</span> <span class="o">=</span> __<span class="o">[</span>2<span class="o">]</span>  &lt;---結果の取り出し
 <span class="o">=</span>&gt; 12
 irb<span class="o">(</span>main<span class="o">)</span>:006:0&gt; <span class="nv">x</span>
 <span class="o">=</span>&gt; 12
</code></pre></div>




<div class="highlight"><pre><code class="ruby"> <span class="no">IRB</span><span class="o">.</span><span class="n">conf</span><span class="o">[</span><span class="ss">:AUTO_INDENT</span><span class="o">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre></div>


<p>これで構文に沿った自動インデントを可能にします。</p>

<div class="highlight"><pre><code class="bash"> irb<span class="o">(</span>main<span class="o">)</span>:001:0&gt; def foo
 irb<span class="o">(</span>main<span class="o">)</span>:002:1&gt;   :foo
 irb<span class="o">(</span>main<span class="o">)</span>:003:1&gt;   <span class="nv">end</span>
 <span class="o">=</span>&gt; nil
 irb<span class="o">(</span>main<span class="o">)</span>:004:0&gt; 
</code></pre></div>


<p>残念ながらendまではうまく処理できません。</p>

<p>プロンプトを変えたいなら、以下のようにします。</p>

<div class="highlight"><pre><code class="ruby"> <span class="no">IRB</span><span class="o">.</span><span class="n">conf</span><span class="o">[</span><span class="ss">:PROMPT</span><span class="o">][</span><span class="ss">:MY_PROMPT</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span>
   <span class="ss">:PROMPT_I</span> <span class="o">=&gt;</span> <span class="s2">&quot;%N(%m)&gt;&gt; &quot;</span><span class="p">,</span>     <span class="c1"># 通常時</span>
   <span class="ss">:PROMPT_N</span> <span class="o">=&gt;</span> <span class="s2">&quot;|  &quot;</span><span class="p">,</span>           <span class="c1"># インデント時</span>
   <span class="ss">:PROMPT_C</span> <span class="o">=&gt;</span> <span class="s2">&quot;.&gt; &quot;</span><span class="p">,</span>           <span class="c1"># 式継続時</span>
   <span class="ss">:PROMPT_S</span> <span class="o">=&gt;</span> <span class="s2">&quot;%l&gt; &quot;</span><span class="p">,</span>          <span class="c1"># 文字継続行</span>
   <span class="ss">:RETURN</span>   <span class="o">=&gt;</span> <span class="s2">&quot;=&gt; %s </span><span class="se">\n</span><span class="s2">&quot;</span>       <span class="c1"># リターン時</span>
 <span class="p">}</span>
 
 <span class="no">IRB</span><span class="o">.</span><span class="n">conf</span><span class="o">[</span><span class="ss">:PROMPT_MODE</span><span class="o">]</span> <span class="o">=</span> <span class="ss">:MY_PROMPT</span>
</code></pre></div>


<p>%N %m %lはそれぞれ、設定したirb名、コンテキスト、セパレータを表します。</p>

<p>セッションごとにプロンプトを変えたいときは、IRB.conf[:IRB_RC]をセットします。</p>

<p>例えば以下を.irbrcに追加します。</p>

<div class="highlight"><pre><code class="ruby"> <span class="no">IRB</span><span class="o">.</span><span class="n">conf</span><span class="o">[</span><span class="ss">:IRB_RC</span><span class="o">]</span> <span class="o">=</span> <span class="nb">lambda</span> <span class="k">do</span> <span class="o">|</span><span class="n">conf</span><span class="o">|</span>
   <span class="k">if</span> <span class="n">conf</span><span class="o">.</span><span class="n">irb_name</span><span class="o">[</span><span class="sr">/\d+/</span><span class="o">]</span>
     <span class="n">context</span> <span class="o">=</span> <span class="s2">&quot;%m(#</span><span class="si">#{</span><span class="vg">$&amp;</span><span class="si">}</span><span class="s2">)&quot;</span>
     <span class="nb">puts</span> <span class="s2">&quot;-- You are in </span><span class="si">#{</span><span class="n">conf</span><span class="o">.</span><span class="n">main</span><span class="si">}</span><span class="s2"> --&quot;</span>
   <span class="k">end</span>
   <span class="n">conf</span><span class="o">.</span><span class="n">prompt_i</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">context</span><span class="si">}</span><span class="s2">&gt;&gt; &quot;</span>
 <span class="k">end</span>
</code></pre></div>


<p>以下のような表示になります。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; :main <span class="o">=</span>&gt; :main
 &gt;&gt; irb
 -- You are in main --
 main<span class="o">(</span><span class="c">#1)&gt;&gt; :main1 =&gt; :main1</span>
 main<span class="o">(</span><span class="c">#1)&gt;&gt; irb Array</span>
 -- You are in Array --
 Array<span class="o">(</span><span class="c">#2)&gt;&gt; :array =&gt; :array</span>
 Array<span class="o">(</span><span class="c">#2)&gt;&gt; </span>
</code></pre></div>


<p>mainでは>>のみを表示し、サブセッションではコンテキスト名とセッション番号を表示します。サブセッションに入るときコンテキスト名をputsします。</p>

<p>.irbrcはRubyのコードとしてirbに読み込まれますから。ここにメソッドなどを定義すれば、トップレベルのメソッドとして使えます。</p>

<div class="highlight"><pre><code class="ruby"> <span class="k">def</span> <span class="nf">now</span>
   <span class="nb">puts</span> <span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y/%m/%d(%a) %H:%M:%S&quot;</span><span class="p">)</span>
 <span class="k">end</span>
</code></pre></div>




<div class="highlight"><pre><code class="bash"> &gt;&gt; now <span class="c">#=&gt; nil</span>
 2010/11/16<span class="o">(</span>Tue<span class="o">)</span> 16:52:42
</code></pre></div>


<p>プロンプトを動的に変えたいときは、以下のようにします。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; conf.prompt_i <span class="o">=</span> <span class="s2">&quot;&gt;&lt;&lt;&lt;&lt;@&gt; &quot;</span> <span class="c">#=&gt; &quot;&gt;&lt;&lt;&lt;&lt;@&gt; &quot;</span>
 &gt;<span class="o">&lt;&lt;&lt;</span>&lt;@&gt; 1 + 2 <span class="c">#=&gt; 3</span>
 &gt;<span class="o">&lt;&lt;&lt;</span>&lt;@&gt; 
 &gt;<span class="o">&lt;&lt;&lt;</span>&lt;@&gt; conf.prompt_mode <span class="o">=</span> :DEFAULT <span class="c">#=&gt; :DEFAULT</span>
irb<span class="o">(</span>main<span class="o">)</span>:011:0&gt; 3 * 4 <span class="c">#=&gt; 12</span>
irb<span class="o">(</span>main<span class="o">)</span>:012:0&gt; 
</code></pre></div>


<p>しかし.irbrcにメソッドを定義すればもっと便利になります。</p>

<div class="highlight"><pre><code class="ruby"> <span class="k">def</span> <span class="nf">prompt</span><span class="p">(</span><span class="n">type</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
   <span class="n">prmt</span> <span class="o">=</span> <span class="o">[</span><span class="ss">:DEFAULT</span><span class="p">,</span> <span class="ss">:SIMPLE</span><span class="p">,</span> <span class="ss">:IRBTOOLS</span><span class="p">,</span> <span class="ss">:KEYES</span><span class="o">]</span>
   <span class="k">case</span> <span class="n">type</span><span class="o">.</span><span class="n">to_s</span>
   <span class="k">when</span> <span class="sr">/^def/i</span> <span class="k">then</span> <span class="n">conf</span><span class="o">.</span><span class="n">prompt_mode</span> <span class="o">=</span> <span class="n">prmt</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
   <span class="k">when</span> <span class="sr">/^sim/i</span> <span class="k">then</span> <span class="n">conf</span><span class="o">.</span><span class="n">prompt_mode</span> <span class="o">=</span> <span class="n">prmt</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
   <span class="k">when</span> <span class="sr">/^irbt/i</span> <span class="k">then</span> <span class="n">conf</span><span class="o">.</span><span class="n">prompt_mode</span> <span class="o">=</span> <span class="n">prmt</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span>
   <span class="k">when</span> <span class="sr">/^key/i</span> <span class="k">then</span> <span class="n">conf</span><span class="o">.</span><span class="n">prompt_mode</span> <span class="o">=</span> <span class="n">prmt</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span>
   <span class="k">when</span> <span class="sr">/^$/</span> <span class="k">then</span> <span class="n">conf</span><span class="o">.</span><span class="n">prompt_mode</span>
   <span class="k">else</span> <span class="no">STDERR</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;give one of them: </span><span class="si">#{</span><span class="n">prmt</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:inspect</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
   <span class="k">end</span>
 <span class="k">end</span>
</code></pre></div>




<div class="highlight"><pre><code class="bash"> IRB on Ruby1.9.2
 &gt;&gt; prompt  <span class="c">#=&gt; :IRBTOOLS</span>
 &gt;&gt; prompt :defo <span class="c">#=&gt; :DEFAULT</span>
 irb<span class="o">(</span>main<span class="o">)</span>:003:0&gt; prompt :SIMPLE <span class="c">#=&gt; :SIMPLE</span>
 &gt;&gt; prompt :new <span class="c">#=&gt; nil</span>
 give one of them: :DEFAULT :SIMPLE :IRBTOOLS :KEYES
 &gt;&gt; 
</code></pre></div>


<p>.irbrcはirb起動時に自動で読み込まれますがfオプションでこれを無視できます。</p>

<div class="highlight"><pre><code class="bash"> irb -f
</code></pre></div>


<h2>拡張ライブラリ</h2>

<p>irbを拡張する複数のライブラリがあります。しかしここでは最強の１つのライブラリを紹介します。それは<code>irbtools</code>ライブラリです。</p>

<h2>irbtoolsライブラリ</h2>

<p><a href="http://rbjl.net/40-irbtools-release-the-power-of-irb">irbtools</a>はirbの主要拡張ライブラリを統合し、さらに細かい多数の機能を追加したライブラリです。<code>gem install irbtools</code>でインストールし、.irbrcで<code>require 'irbtools'</code>することで使えるようになります。</p>

<p>irbtoolsには以下のライブラリが統合されています。</p>

<blockquote><p>wirble fancy_irb fileutils coderay clipboard
zucker ap yaml g guessmethod interactive_editor
sketches boson hirb</p></blockquote>

<p>特定のライブラリを外したい場合は.irbrcを以下のようにします。</p>

<div class="highlight"><pre><code class="ruby"> <span class="c1">#require &#39;irbtools&#39;</span>
 <span class="nb">require</span> <span class="s2">&quot;irbtools/configure&quot;</span>
 
 <span class="no">Irbtools</span><span class="o">.</span><span class="n">libraries</span> <span class="o">-=</span> <span class="sx">%w(fileutils hirb)</span>
 <span class="no">Irbtools</span><span class="o">.</span><span class="n">start</span>
</code></pre></div>


<h2>色付けとロケットプロンプト</h2>

<p>irbtoolsをrequireしてirbを起動すると、Ruby情報を含むwelcomeメッセージのあとシンプルなプロンプトが現れます。戻り値はスペースが許す場合入力行の右に色付けされて出力されます。</p>

<p><img src="http://img.f.hatena.ne.jp/images/fotolife/k/keyesberry/20101116/20101116212416.png" alt="image" /></p>

<p>返り値が色付けされて右に来ることで、出力も見やすくなります。この機能はwirbleとfancy_irbライブラリによって実現されています<sup id='fnref:2'><a href='#fn:2' rel='footnote'>2</a></sup>。</p>

<h2>多様な出力形式</h2>

<p>irbtoolsは多様な出力形式をサポートします。</p>

<p><img src="http://img.f.hatena.ne.jp/images/fotolife/k/keyesberry/20101116/20101116212417.png" alt="image" /></p>

<p>oは現在の行、ファイル、メソッドを、cはコールスタックを出力します。yはyaml形式、gはgrowlへの出力をします。tableはデータを表形式で出力します。これらの出力形式はawesome_print, zucker/debug, yaml、g、hirbなどのライブラリによって実現されています。</p>

<h2>コマンド群</h2>

<p>irbtoolsによって便利なコマンド群が用意されています。まずls, cat, mkdir, rm, touchその他のファイルユーティリティコマンドがあります。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; <span class="nv">ls</span>
 <span class="o">=</span>&gt; <span class="o">[</span><span class="s2">&quot;console&quot;</span>, <span class="s2">&quot;iphone&quot;</span>, <span class="s2">&quot;irbtools.txt&quot;</span>, <span class="s2">&quot;lisr&quot;</span>, <span class="s2">&quot;lorem.txt&quot;</span>, <span class="s2">&quot;math.rb&quot;</span>, <span class="s2">&quot;twilog.txt&quot;</span>, <span class="s2">&quot;uni.rb&quot;</span>, <span class="s2">&quot;unicode.txt&quot;</span>, <span class="s2">&quot;user.db&quot;</span>, <span class="s2">&quot;user.rb&quot;</span><span class="o">]</span>
 &gt;&gt; <span class="nv">s</span> <span class="o">=</span> cat <span class="s2">&quot;lorem.txt&quot;</span>
 <span class="o">=</span>&gt; <span class="s2">&quot;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis...&quot;</span>
 &gt;&gt; <span class="nb">pwd</span> <span class="c">#=&gt; &quot;/Users/keyes/Dropbox/workspace&quot;</span>
 &gt;&gt; 
</code></pre></div>


<p>Rubyファイルを表示する場合はCodeRayによるrayコマンドがいいです。引数で渡されたファイルがSyntax Highlightで表示されます<sup id='fnref:3'><a href='#fn:3' rel='footnote'>3</a></sup>。</p>

<p><img src="http://img.f.hatena.ne.jp/images/fotolife/k/keyesberry/20101116/20101116212418.png" alt="image" /></p>

<p>もっともCodeRayは本来HTMLを生成するものですから、その例を示したほうがいいですね。</p>

<p>user.rbを読み込んでhtmlを生成します。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; <span class="nv">user_html</span> <span class="o">=</span> CodeRay.scan<span class="o">(</span>cat<span class="o">(</span><span class="s2">&quot;user.rb&quot;</span><span class="o">)</span>, :ruby<span class="o">)</span>.page
 <span class="o">=</span>&gt; <span class="s2">&quot;&lt;!DOCTYPE html PUBLIC &quot;</span>-//W3C//DTD XHTML 1.0 Strict//EN<span class="s2">&quot;\n  &quot;</span>http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd<span class="err">&quot;</span>&gt;<span class="se">\n</span>...
</code></pre></div>


<p>結果をuser.htmlファイルに書き込みます。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; File.open<span class="o">(</span><span class="s1">&#39;user.html&#39;</span>,<span class="s1">&#39;w&#39;</span><span class="o">)</span> <span class="o">{</span>|f| f.write user_html <span class="o">}</span> <span class="c">#=&gt; 6366</span>
</code></pre></div>


<p>ブラウザで見てみます。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; system<span class="o">(</span><span class="s1">&#39;open&#39;</span>, <span class="s1">&#39;user.html&#39;</span><span class="o">)</span> <span class="c">#=&gt; true</span>
 &gt;&gt; 
</code></pre></div>


<p><img src="http://img.f.hatena.ne.jp/images/fotolife/k/keyesberry/20101117/20101117191617.png" alt="image" /></p>

<p>いいですね。</p>

<p>クリップボードとやり取りするためのcopy, paste, copy_inputがあります。copy_inputはirbの全セッションをコピーします。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; <span class="nv">site</span> <span class="o">=</span> paste <span class="c">#=&gt; &quot;http://d.hatena.ne.jp/keyesberry/&quot;</span>
 &gt;&gt; copy Math::PI <span class="c">#=&gt; &quot;3.141592653589793&quot;</span>
 &gt;&gt; copy_input  <span class="c">#=&gt; &quot;The session input history has been copied to the clipboard.&quot;</span>
 &gt;&gt; 
</code></pre></div>


<p>requireとloadのショートカットrqとld、requireし直すrerequireがあります。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; rq:mathn <span class="c">#=&gt; true</span>
 &gt;&gt; rq:<span class="s1">&#39;open-uri&#39;</span> <span class="c">#=&gt; true</span>
 &gt;&gt; ld:json <span class="c">#=&gt; true</span>
</code></pre></div>


<p>入力履歴を出力するsession_history、irbにログインし直すreset!、画面をフラッシュするclearがあります。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; Math::PI <span class="c">#=&gt; 3.141592653589793</span>
 &gt;&gt; puts <span class="s1">&#39;helo&#39;</span> <span class="c">#=&gt; nil</span>
 helo
 &gt;&gt; 1 + 3 <span class="c">#=&gt; 4</span>
 &gt;&gt; %w<span class="o">(</span>apple grape orange<span class="o">)</span> <span class="c">#=&gt; [&quot;apple&quot;, &quot;grape&quot;, &quot;orange&quot;]</span>
 &gt;&gt; session_history 4 <span class="c">#=&gt; &quot;puts &#39;helo&#39;\n1 + 3\n%w(apple grape orange)&quot;</span>
 &gt;&gt; reset!
 IRB on Ruby1.9.2
 &gt;&gt; clear
</code></pre></div>


<p>OSやRubyのバージョンを調べる、OS RubyEngine RubyVersionがあります。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; OS <span class="c">#=&gt; darwin8</span>
 &gt;&gt; RubyEngine  <span class="c">#=&gt; mri</span>
 &gt;&gt; RE <span class="c">#=&gt; mri</span>
 &gt;&gt; RubyVersion  <span class="c">#=&gt; 1.9.2</span>
 &gt;&gt; RV <span class="c">#=&gt; 1.9.2</span>
 &gt;&gt; 
 &gt;&gt; OS.windows? <span class="c">#=&gt; false</span>
 &gt;&gt; OS.linux? <span class="c">#=&gt; false</span>
 &gt;&gt; OS.mac? <span class="c">#=&gt; true</span>
 &gt;&gt; RE.jruby? <span class="c">#=&gt; false</span>
 &gt;&gt; RE.rubinius? <span class="c">#=&gt; false</span>
</code></pre></div>


<p>これらの機能はzucker Clipboardライブラリで実現されます。</p>

<h2>エディタ支援</h2>

<p>irbからエディタを呼び出し、そこで編集した内容をirb上に返す機能があります。vi, vim, emacs, mate, ed<sup id='fnref:4'><a href='#fn:4' rel='footnote'>4</a></sup>などのコマンドでエディタが起動し一時ファイルを開きます。編集後エディタを閉じればirb内でそのコードを利用できます。</p>

<p>同じセッションで同じコマンドを使えば、同じ一時ファイルが開いて再編集ができるようになります。コマンドに特定のファイルを渡すこともできます。これはInteractive_editorライブラリにより実現されています。</p>

<p>同じような目的でSketchesライブラリがあります。こちらはエディタを閉じることなく、内容をirbに反映させることができます。</p>

<p>.irbrcでsketchesで使用するエディタをセットします。</p>

<div class="highlight"><pre><code class="ruby"> <span class="no">Sketches</span><span class="o">.</span><span class="n">config</span> <span class="ss">:editor</span> <span class="o">=&gt;</span> <span class="s1">&#39;mate&#39;</span><span class="p">,</span> <span class="ss">:background</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</code></pre></div>


<p>上記設定をしない場合は、環境変数$EDITORが参照されます。</p>

<p>skecthコマンドで指定エディタが起動します。エディタを閉じずに内容を保存します。これでirbにコードが反映されます。名前付きスケッチも作れます。sketchesでスケッチの一覧を表示します。save_sketchでスケッチをファイルに保存することもできます。</p>

<div class="highlight"><pre><code class="bash"> IRB on Ruby1.9.2
 &gt;&gt; sketch <span class="c">#=&gt; nil</span>
 &gt;&gt; fact 20 <span class="c">#=&gt; 2432902008176640000</span>
 &gt;&gt; sketch :fib <span class="c">#=&gt; nil</span>
 &gt;&gt; fib 20 <span class="c">#=&gt; 6765</span>
 &gt;&gt; sketches <span class="c">#=&gt; nil</span>
 <span class="c">#1</span>
 
   def fact<span class="o">(</span>n<span class="o">)</span>
     <span class="o">(</span>1..n<span class="o">)</span>.inject<span class="o">(</span>:*<span class="o">)</span>
   end  ...
 <span class="c">#2: fib</span>
   def fib<span class="o">(</span>n<span class="o">)</span>
     <span class="o">[</span>0,1<span class="o">]</span>.include?<span class="o">(</span>n<span class="o">)</span> ? n : fib<span class="o">(</span>n-1<span class="o">)</span> + fib<span class="o">(</span>n-2<span class="o">)</span>
   end
   ...
 &gt;&gt; name_sketch 1, :fact <span class="c">#=&gt; nil</span>
 &gt;&gt; save_sketch :fib, <span class="s2">&quot;fib.rb&quot;</span> <span class="c">#=&gt; nil</span>
 &gt;&gt; 
</code></pre></div>


<h2>コマンドの登録</h2>

<p>bosonライブラリを使うことによって、効率的にコマンドを登録管理できます。どんなbosonコマンドがあるか確認するには、commandsコマンドを使います。</p>

<div class="highlight"><pre><code class="bash">&gt;&gt; commands  <span class="c">#=&gt; true</span>
+--------------+----------+--------+------------+
| full_name    | lib      | usage  | description|
+--------------+----------+--------+------------+
| render       | core     | <span class="o">[</span>object| Render any |
| menu         | core     | <span class="o">[</span>arr<span class="o">]</span> <span class="o">[</span>| Provide a m|
| usage        | core     | <span class="o">[</span>comman| Print a com|
| commands     | core     | <span class="o">[</span><span class="nv">query</span><span class="o">=</span>| List or sea|
| libraries    | core     | <span class="o">[</span><span class="nv">query</span><span class="o">=</span>| List or sea|
| load_library | core     | <span class="o">[</span>librar| Load a libr|
| get          | web_core | <span class="o">[</span>url<span class="o">]</span> <span class="o">[</span>| Gets the bo|
| post         | web_core | <span class="o">[</span>url<span class="o">]</span> <span class="o">[</span>| Posts to a |
| build_url    | web_core | <span class="o">[</span>url<span class="o">]</span> <span class="o">[</span>| Builds a ur|
| browser      | web_core | <span class="o">[</span>*urls<span class="o">]</span>| Opens urls |
| install      | web_core | <span class="o">[</span>url<span class="o">][</span>-| Installs a |
+--------------+----------+--------+------------+
11 rows in <span class="nb">set</span>
&gt;&gt; 
</code></pre></div>


<p>テーブルはターミナルの幅に合わせてtruncateされます<sup id='fnref:5'><a href='#fn:5' rel='footnote'>5</a></sup>。</p>

<p>irbではそのままコマンドを使えます。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; <span class="nv">site</span> <span class="o">=</span> get <span class="s2">&quot;http://d.hatena.ne.jp/&quot;</span>
 <span class="o">=</span>&gt; <span class="s2">&quot;&lt;!DOCTYPE HTML PUBLIC &quot;</span>-//W3C//DTD HTML 4.01 Transitional//EN<span class="s2">&quot;&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n&lt;meta http-equiv=&quot;</span>Content-Type<span class="s2">&quot; content=&quot;</span>text/html; <span class="nv">charset</span><span class="o">=</span>euc-jp<span class="s2">&quot;&gt;\n&lt;meta http-equiv=&quot;</span>Content-Style-Type<span class="err">&quot;</span>
</code></pre></div>


<p>独自のコマンドを追加してみましょう。bosonのインストールでできた~/.boson/commandsディレクトリに、以下のようなRubyモジュールを作ります。</p>

<div class="highlight"><pre><code class="bash"> vi .boson/commands/mymath.rb
</code></pre></div>




<div class="highlight"><pre><code class="ruby"> <span class="k">module</span> <span class="nn">MyMath</span>
   <span class="c1">#calculate fibonacci</span>
   <span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
     <span class="n">n</span> <span class="o">=</span> <span class="nb">Integer</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
     <span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">].</span><span class="n">include?</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">?</span> <span class="n">n</span> <span class="p">:</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
   <span class="k">rescue</span>
     <span class="n">only_positive_error_msg</span>
   <span class="k">end</span>
 
   <span class="c1">#calculate factorial</span>
   <span class="k">def</span> <span class="nf">fact</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
     <span class="n">n</span> <span class="o">=</span> <span class="nb">Integer</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
     <span class="k">raise</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span>
     <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fact</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
   <span class="k">rescue</span>
     <span class="n">only_positive_error_msg</span>
   <span class="k">end</span>
 
   <span class="kp">private</span>
   <span class="k">def</span> <span class="nf">only_positive_error_msg</span>
     <span class="no">STDERR</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;Only accept POSITIVE integer!&quot;</span>
   <span class="k">end</span>
 <span class="k">end</span>
</code></pre></div>


<p>再度コマンド一覧を見ます。</p>

<div class="highlight"><pre><code class="bash">&gt;&gt; commands 
+--------------+----------+--------+------------+
| full_name    | lib      | usage  | description|
+--------------+----------+--------+------------+
| render       | core     | <span class="o">[</span>object| Render any |
| menu         | core     | <span class="o">[</span>arr<span class="o">]</span> <span class="o">[</span>| Provide a m|
| usage        | core     | <span class="o">[</span>comman| Print a com|
| commands     | core     | <span class="o">[</span><span class="nv">query</span><span class="o">=</span>| List or sea|
| libraries    | core     | <span class="o">[</span><span class="nv">query</span><span class="o">=</span>| List or sea|
| load_library | core     | <span class="o">[</span>librar| Load a libr|
| get          | web_core | <span class="o">[</span>url<span class="o">]</span> <span class="o">[</span>| Gets the bo|
| post         | web_core | <span class="o">[</span>url<span class="o">]</span> <span class="o">[</span>| Posts to a |
| build_url    | web_core | <span class="o">[</span>url<span class="o">]</span> <span class="o">[</span>| Builds a ur|
| browser      | web_core | <span class="o">[</span>*urls<span class="o">]</span>| Opens urls |
| install      | web_core | <span class="o">[</span>url<span class="o">][</span>-| Installs a |
| fib          | mymath   | <span class="o">[</span>n<span class="o">]</span>    | calculate f|
| fact         | mymath   | <span class="o">[</span>n<span class="o">]</span>    | calculate f|
+--------------+----------+--------+------------+
13 rows in <span class="nb">set</span>
&gt;&gt; 
</code></pre></div>


<p>mymathライブラリの２つのコマンドが追加されています。</p>

<p>実行してみましょう。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; fib 10 <span class="c">#=&gt; 55</span>
 &gt;&gt; fact 15 <span class="c">#=&gt; 1307674368000</span>
 &gt;&gt; fib :hello <span class="c">#=&gt; nil</span>
 Only accept POSITIVE integer!
 &gt;&gt; fact <span class="s1">&#39;hi&#39;</span> <span class="c">#=&gt; nil</span>
 Only accept POSITIVE integer!
 &gt;&gt; 
</code></pre></div>


<p>bosonの優れたところは、これらのコマンドをShellでも使える点にあります。shellではbosonを前置してコマンドを実行します。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; <span class="nb">exit</span>
 % boson fib 10
 55
 % boson fact 15
 1307674368000
 % boson fib :hello
 Only accept POSITIVE integer!
 % boson fact <span class="s1">&#39;hi&#39;</span>
 Only accept POSITIVE integer!
 % 
</code></pre></div>


<h2>テーブル／ツリー出力</h2>

<p>先にも書きましたがtableコマンドはデータを表形式で出力します。これはデータベースと共に使うと更に便利です。先に出てきたUserDBにhomepageのpropertyを追加して表示します。</p>

<div class="highlight"><pre><code class="bash"> IRB on Ruby1.9.2
 &gt;&gt; rq:user <span class="c">#=&gt; true</span>
 &gt;&gt; User.all
 <span class="o">=</span>&gt; <span class="o">[</span><span class="c">#&lt;User @id=1 @nickname=&quot;Charlie&quot; @email=&quot;charlie@abc.com&quot; @homepage=&quot;http://www.nintendo.com&quot;&gt;, #&lt;User @id=2 @nickname=&quot;Tommy&quot; @email=&quot;tommy@abc.com&quot; @homepage=&quot;http://twitter.com/merborne/&quot;&gt;, #&lt;User @id=3 @nickname=&quot;Alice&quot; @email=&quot;alice@xyz.com&quot; @homepage=&quot;http://d.hatena.ne.jp/keyesberry/&quot;&gt;]</span>
</code></pre></div>


<p>これをtable表示します。</p>

<div class="highlight"><pre><code class="bash">&gt;&gt; table User.all <span class="c">#=&gt; true</span>
 ----+----------+-----------------+----------------+
| id | nickname | email           | homepage       |
 ----+----------+-----------------+----------------+
| 1  | Charlie  | charlie@abc.com | http://www.nin |
| 2  | Tommy    | tommy@abc.com   | http://twitter |
| 3  | Alice    | alice@xyz.com   | http://d.haten |
 ----+----------+-----------------+----------------+
3 rows in <span class="nb">set</span>
</code></pre></div>


<p>条件で絞り込みます。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; table User.all<span class="o">(</span>:email.like<span class="o">=</span>&gt;<span class="s2">&quot;%@abc.com&quot;</span><span class="o">)</span> <span class="c">#=&gt; true</span>
 +----+----------+-----------------+---------------+
 | id | nickname | email           | homepage      |
 +----+----------+-----------------+---------------+
 | 1  | Charlie  | charlie@abc.com | http://www.nin|
 | 2  | Tommy    | tommy@abc.com   | http://twitter|
 +----+----------+-----------------+---------------+
 2 rows in <span class="nb">set</span>
 &gt;&gt; 
</code></pre></div>


<p>menuというコマンドを使うと表から値を抽出できます。以下の例ではTommyとAliceのhomepageを抽出して、それをbrowserコマンドに渡して開いています。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; <span class="nv">choices</span> <span class="o">=</span> menu User.all, :fields<span class="o">=</span>&gt;<span class="o">[</span>:nickname, :homepage<span class="o">]</span>, :two_d<span class="o">=</span>&gt;true
 +--------+----------+----------------------------+
 | number | nickname | homepage                   |
 +--------+----------+----------------------------+
 | 1      | Charlie  | http://www.nintendo.com    |
 | 2      | Tommy    | http://twitter.com/merborn |
 | 3      | Alice    | http://d.hatena.ne.jp/keye |
 +--------+----------+----------------------------+
 3 rows in <span class="nb">set</span>
<span class="nb"> </span>Specify individual choices <span class="o">(</span>4,7<span class="o">)</span>, range of choices <span class="o">(</span>1-3<span class="o">)</span> or all choices <span class="o">(</span>*<span class="o">)</span>.
 Default field: nickname
 Choose: 2,3:h
 <span class="o">=</span>&gt; <span class="o">[</span><span class="s2">&quot;http://twitter.com/merborne/&quot;</span>, <span class="s2">&quot;http://d.hatena.ne.jp/keyesberry/&quot;</span><span class="o">]</span>
 &gt;&gt; browser *choices <span class="c">#=&gt; true</span>
 &gt;&gt; 
</code></pre></div>


<p>ツリー表示を実現するviewというコマンドもあります。Rubyのクラスツリーを作ってみます。</p>

<div class="highlight"><pre><code class="bash"> &gt;&gt; <span class="nv">class_tree</span> <span class="o">=</span> <span class="o">[[</span>0,:Object<span class="o">]</span>,<span class="o">[</span>1,:Array<span class="o">]</span>,<span class="o">[</span>1,:Binding<span class="o">]</span>,<span class="o">[</span>1,:Continuation<span class="o">]</span>,<span class="o">[</span>1,:Data<span class="o">]</span>,<span class="o">[</span>1,:Dir<span class="o">]</span>,<span class="o">[</span>1,:Hash<span class="o">]</span>,<span class="o">[</span>1,:IO<span class="o">]</span>,<span class="o">[</span>2,:File<span class="o">]</span>,<span class="o">[</span>2,:BasicSocket<span class="o">]</span>,<span class="o">[</span>3,:IPSocket<span class="o">]</span>,<span class="o">[</span>3,:UNIXSocket<span class="o">]</span>,<span class="o">[</span>3,:Socket<span class="o">]</span>,<span class="o">[</span>4,:TCPSocket<span class="o">]</span>,<span class="o">[</span>4,:UDPSocket<span class="o">]</span>,<span class="o">[</span>4,:UNIXServer<span class="o">]</span>,<span class="o">[</span>5,:TCPServer<span class="o">]</span>,<span class="o">[</span>1,:MatchData<span class="o">]</span>,<span class="o">[</span>1,:Method<span class="o">]</span>,<span class="o">[</span>1,:Module<span class="o">]</span>,<span class="o">[</span>2,:Class<span class="o">]</span>,<span class="o">[</span>1,:Numeric<span class="o">]</span>,<span class="o">[</span>2,:Float<span class="o">]</span>,<span class="o">[</span>2,:Integer<span class="o">]</span>,<span class="o">[</span>3,:Bignum<span class="o">]</span>,<span class="o">[</span>3,:Fixnum<span class="o">]</span>,<span class="o">[</span>1,:Proc<span class="o">]</span>,<span class="o">[</span>1,:Range<span class="o">]</span>,<span class="o">[</span>1,:Regexp<span class="o">]</span>,<span class="o">[</span>1,:String<span class="o">]</span>,<span class="o">[</span>1,:Struct<span class="o">]</span>,<span class="o">[</span>1,:Symbol<span class="o">]</span>,<span class="o">[</span>1,:Thread<span class="o">]</span>,<span class="o">[</span>1,:ThreadGroup<span class="o">]</span>,<span class="o">[</span>1,:Time<span class="o">]]</span>
 <span class="o">=</span>&gt; <span class="o">[[</span>0, :Object<span class="o">]</span>, <span class="o">[</span>1, :Array<span class="o">]</span>, <span class="o">[</span>1, :Binding<span class="o">]</span>, <span class="o">[</span>1, :Continuation<span class="o">]</span>, <span class="o">[</span>1, :Data<span class="o">]</span>, <span class="o">[</span>1, :Dir<span class="o">]</span>, <span class="o">[</span>1, :Hash<span class="o">]</span>, <span class="o">[</span>1, :IO<span class="o">]</span>, <span class="o">[</span>2, :File<span class="o">]</span>, <span class="o">[</span>2, :BasicSocket<span class="o">]</span>, <span class="o">[</span>3, :IPSocket<span class="o">]</span>, <span class="o">[</span>3, :UNIXSocket<span class="o">]</span>, <span class="o">[</span>3, :Socket<span class="o">]</span>, <span class="o">[</span>4, :TCPSocket<span class="o">]</span>, <span class="o">[</span>4, :UDPSocket<span class="o">]</span>, <span class="o">[</span>4, :UNIXServer<span class="o">]</span>, <span class="o">[</span>5, :TCPServer<span class="o">]</span>, <span class="o">[</span>1, :MatchData<span class="o">]</span>, <span class="o">[</span>1, :Method<span class="o">]</span>, <span class="o">[</span>1, :Module<span class="o">]</span>, <span class="o">[</span>2, :Class<span class="o">]</span>, <span class="o">[</span>1, :Numeric<span class="o">]</span>, <span class="o">[</span>2, :Float<span class="o">]</span>, <span class="o">[</span>2, :Integer<span class="o">]</span>, <span class="o">[</span>3, :Bignum<span class="o">]</span>, <span class="o">[</span>3, :Fixnum<span class="o">]</span>, <span class="o">[</span>1, :Proc<span class="o">]</span>, <span class="o">[</span>1, :Range<span class="o">]</span>, <span class="o">[</span>1, :Regexp<span class="o">]</span>, <span class="o">[</span>1, :String<span class="o">]</span>, <span class="o">[</span>1, :Struct<span class="o">]</span>, <span class="o">[</span>1, :Symbol<span class="o">]</span>, <span class="o">[</span>1, :Thread<span class="o">]</span>, <span class="o">[</span>1, :ThreadGroup<span class="o">]</span>, <span class="o">[</span>1, :Time<span class="o">]]</span>
 &gt;&gt; view class_tree, :class<span class="o">=</span>&gt;:tree, :type<span class="o">=</span>&gt;:directory <span class="c">#=&gt; true</span>
 Object
 |-- Array|-- Binding|-- Continuation
 |-- Data
 |-- Dir
 |-- Hash
 |-- IO
 |   |-- File
 |   <span class="sb">`</span>-- BasicSocket
 |       |-- IPSocket
 |       |-- UNIXSocket
 |       <span class="sb">`</span>-- Socket
 |           |-- TCPSocket
 |           |-- UDPSocket
 |           <span class="sb">`</span>-- UNIXServer
 |               <span class="sb">`</span>-- TCPServer
 |-- MatchData
 |-- Method
 |-- Module
 |   <span class="sb">`</span>-- Class
 |-- Numeric
 |   |-- Float
 |   <span class="sb">`</span>-- Integer
 |       |-- Bignum
 |       <span class="sb">`</span>-- Fixnum
 |-- Proc
 |-- Range
 |-- Regexp
 |-- String
 |-- Struct
 |-- Symbol
 |-- Thread
 |-- ThreadGroup
 <span class="sb">`</span>-- Time
 &gt;&gt; 
</code></pre></div>


<p>これらはHirbというライブラリで実現しますが、このライブラリは奥が深そうです。</p>

<p><a href="http://tagaholic.me/2009/03/18/ruby-class-trees-rails-plugin-trees-with-hirb.html">Tagaholic - Ruby Class and Rails Plugin Trees With Hirb</a></p>

<h2>irbtoolsにおける若干のカスタマイズ</h2>

<p>プロンプトの形と出力の色は以下のようにしてカスタマイズできます。</p>

<div class="highlight"><pre><code class="ruby"> <span class="c1">#require &#39;irbtools&#39;</span>
 <span class="nb">require</span> <span class="s2">&quot;irbtools/configure&quot;</span>
 <span class="no">Irbtools</span><span class="o">.</span><span class="n">libraries</span> <span class="o">-=</span> <span class="sx">%w(fancy_irb)</span>
 <span class="no">Irbtools</span><span class="o">.</span><span class="n">start</span>
 
 <span class="nb">require</span> <span class="s2">&quot;fancy_irb&quot;</span>
 <span class="no">FancyIrb</span><span class="o">.</span><span class="n">start</span><span class="p">(</span>
  <span class="ss">:rocket_prompt</span>   <span class="o">=&gt;</span> <span class="s1">&#39;&gt;&lt;&lt;&lt;&lt;@&gt; &#39;</span><span class="p">,</span>
 <span class="c1"># :result_prompt   =&gt; &#39;=&gt; &#39;,</span>
  <span class="ss">:colorize</span> <span class="o">=&gt;</span> <span class="p">{</span>             
    <span class="ss">:rocket_prompt</span> <span class="o">=&gt;</span> <span class="ss">:yellow</span><span class="p">,</span>
 <span class="c1">#   :result_prompt =&gt; :blue,</span>
 <span class="c1">#   :input_prompt  =&gt; nil,</span>
 <span class="c1">#   :irb_errors    =&gt; :red,</span>
 <span class="c1">#   :stderr        =&gt; :light_red,</span>
    <span class="ss">:stdout</span>        <span class="o">=&gt;</span> <span class="ss">:cyan</span><span class="p">,</span>
 <span class="c1">#   :input         =&gt; nil,</span>
 <span class="c1">#   :output        =&gt; true,</span>
  <span class="p">}</span>
 <span class="p">)</span>
</code></pre></div>


<p>fancy_irbをirbtoolsから外し独立してrequireします。FancyIrb.startの引数に自分の設定を渡します<sup id='fnref:6'><a href='#fn:6' rel='footnote'>6</a></sup>。</p>

<p><img src="http://img.f.hatena.ne.jp/images/fotolife/k/keyesberry/20101116/20101116212419.png" alt="image" /></p>

<p>welcomeメッセージを変えることもできます。</p>

<div class="highlight"><pre><code class="ruby"> <span class="c1">#require &#39;irbtools&#39;</span>
 <span class="nb">require</span> <span class="s2">&quot;irbtools/configure&quot;</span>
 <span class="no">Irbtools</span><span class="o">.</span><span class="n">welcome_message</span> <span class="o">=</span> <span class="s2">&quot;IRB on Ruby</span><span class="si">#{</span> <span class="no">RUBY_VERSION</span> <span class="si">}</span><span class="s2">&quot;</span>
 <span class="no">Irbtools</span><span class="o">.</span><span class="n">start</span>
</code></pre></div>


<p>irbtoolsライブラリを入れることで、irbはかなり強力なものになります。是非とも試してみてください。</p>

<p>非常に長くなりました。最後までお付き合いありがとうございます！</p>

<h2>参考URLs</h2>

<p><a href="http://doc.okkez.net/192/view/library/irb">library irb</a></p>

<p><a href="http://rbjl.net/40-irbtools-release-the-power-of-irb">irbtools / Release the power of irb!</a>
<a href="http://pablotron.org/software/wirble/">Pablotron: Wirble</a>
<a href="https://github.com/janlelis/fancy_irb">janlelis's fancy_irb at master - GitHub</a>
<a href="http://coderay.rubychan.de/">CodeRay</a>
<a href="http://rubyzucker.info/">Ruby Zucker 8</a>
<a href="https://github.com/michaeldv/awesome_print">michaeldv's awesome_print at master - GitHub</a>
<a href="https://github.com/jugyo/g">jugyo's g at master - GitHub</a>
<a href="https://github.com/jberkel/interactive_editor">jberkel's interactive_editor at master - GitHub</a>
<a href="http://sketches.rubyforge.org/">Sketches - About</a>
<a href="http://tagaholic.me/2009/10/14/boson-command-your-ruby-universe.html">Boson - Command Your Ruby Universe</a>
<a href="http://tagaholic.me/2009/03/13/hirb-irb-on-the-good-stuff.html">Hirb - Irb On The Good Stuff</a></p>

<p>(追記：2010-11-17) CodeRayのHTML出力について記述を追加しました。</p>

<p>(追記：2010-11-18) CodeRayの記述の間違いを修正しました。</p>

<p>(追記：2010-11-20) .irbrcへのメソッド定義についての記述を追加しました。</p>

<p>(参考)：<a href="http://ja.wikipedia.org/wiki/IRB">IRB Wikipedia</a></p>

<div class="footnotes">
    <ol>
        <li id='fn:1'>内側のローカル変数はできないみたいです <a href='#fnref:1' rev='footnote'>↩</a></li><li id='fn:2'>fancy_irbは出力の態様によって問題が出るときがあります <a href='#fnref:2' rev='footnote'>↩</a></li><li id='fn:3'>ファイルの読み込みは別途requireする必要があります <a href='#fnref:3' rev='footnote'>↩</a></li><li id='fn:4'>環境変数$EDITORにセットしたエディタが起動します <a href='#fnref:4' rev='footnote'>↩</a></li><li id='fn:5'>ブログ掲載のため項目を削っています <a href='#fnref:5' rev='footnote'>↩</a></li><li id='fn:6'>もしかしたらもう少しスマートなやり方があるかも知れません <a href='#fnref:6' rev='footnote'>↩</a></li>
    </ol>
</div>





    <div class="ad" id="topAdsense">
      <script type="text/javascript"><!--
      google_ad_client = "ca-pub-8790567277062819";
      /* foot */
      google_ad_slot = "7511276945";
      google_ad_width = 728;
      google_ad_height = 90;
      //-->
      </script>
      <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script>
    </div>

    <hr>
    <ul class="social_button inline">
      <li id="hatena">
  <a href="http://b.hatena.ne.jp/entry/http://melborne.github.io/2010/11/16/IRB-Rubyist/" class="hatena-bookmark-button" data-hatena-bookmark-title="IRB　それはRubyistの魔法のランプ" data-hatena-bookmark-layout="horizontal" title="このエントリーをはてなブックマークに追加"><img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" width="20" height="30" style="border: none;" /></a><script type="text/javascript" src="http://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
</li>

<li id="twitter">
  <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://melborne.github.io/2010/11/16/IRB-Rubyist/" data-text="IRB　それはRubyistの魔法のランプ" data-via="merborne" data-lang="ja" data-size="" data-count="horizontal"></a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</li>

<li id="google">
  <link rel="canonical" href="http://melborne.github.io/2010/11/16/IRB-Rubyist/" />
  <g:plusone size="medium"></g:plusone>
  
  <script type="text/javascript">
    window.___gcfg = {lang: 'ja'};
  
    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>
</li>

<li id="facebook">
  <div class="fb-like" data-href="http://melborne.github.io/2010/11/16/IRB-Rubyist/" data-layout="button_count" data-send="false" data-width="150" data-show-faces="false"></div>
</li>

<li></li>




    </ul>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2010/11/11/Ruby" title="Rubyのメソッドに別名があってもいいじゃないか">&larr; Previous</a></li>
      
        <li><a href="/">Archive</a></li>
        <!--<li><a href="/archive.html">Archive</a></li>-->
      
        <li class="next"><a href="/2010/11/27/OSX" title="キー配列を最適化してプログラミングの生産性を倍にしよう！　OSX限定">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'melborne'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
  
  <div class="span3">
    <div id="bookAd">
      <a href="/books/">
        <!--<img src="/assets/images/2012/start_ruby.jpg" alt="start_ruby" />-->
        <!--<img src="/assets/images/2012/jekyll_cover.jpg" alt="jekyll" />-->
        <!--<img src="/assets/images/2012/ruby_parallel_cover.png" alt="ruby_parallel" />-->
        <!--<img src="/assets/images/2012/js_oop_cover.png" alt="js_oop" />-->
        <!--<img src="/assets/images/2012/rack_cover.png" alt="rack" />-->
        <!--<img src="/assets/images/2013/02/ruby_object_cover.png" alt="ruby_object" />-->
        <img src="/assets/images/2013/03/ruby_trivia_cover.png" alt="ruby_trivia" />
      </a>
      <p id="comment">100円で好評発売中！<br/><a href="/books/">M'ELBORNE BOOKS</a></p>
    </div>

    <hr />
    

    <ul class="social_button inline">
      <li id="hatena">
  <a href="http://b.hatena.ne.jp/entry/http://melborne.github.io/2010/11/16/IRB-Rubyist/" class="hatena-bookmark-button" data-hatena-bookmark-title="IRB　それはRubyistの魔法のランプ" data-hatena-bookmark-layout="horizontal" title="このエントリーをはてなブックマークに追加"><img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="このエントリーをはてなブックマークに追加" width="20" height="30" style="border: none;" /></a><script type="text/javascript" src="http://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
</li>

<li id="twitter">
  <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://melborne.github.io/2010/11/16/IRB-Rubyist/" data-text="IRB　それはRubyistの魔法のランプ" data-via="merborne" data-lang="ja" data-size="" data-count="horizontal"></a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</li>

<li id="google">
  <link rel="canonical" href="http://melborne.github.io/2010/11/16/IRB-Rubyist/" />
  <g:plusone size="medium"></g:plusone>
  
  <script type="text/javascript">
    window.___gcfg = {lang: 'ja'};
  
    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>
</li>

<li id="facebook">
  <div class="fb-like" data-href="http://melborne.github.io/2010/11/16/IRB-Rubyist/" data-layout="button_count" data-send="false" data-width="150" data-show-faces="false"></div>
</li>

<li></li>




    </ul>

    <div class="ad" id="sideAdsense">
      <script type="text/javascript"><!--
      google_ad_client = "ca-pub-8790567277062819";
      /* sidebar */
      google_ad_slot = "0672114662";
      google_ad_width = 160;
      google_ad_height = 600;
      //-->
      </script>
      <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script>
    </div>
  </div>
</div>


      </div>

      <footer>
        <p><a rel="license" href="http://creativecommons.org/licenses/by-nc/2.1/jp/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc/2.1/jp/88x31.png" /></a>  kyoendo 2012 
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>        </p>
      </footer>

    </div> <!-- /container -->

    

    <script type="text/javascript">
      if (location.hostname != 'localhost') {
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-288751-18']);
        _gaq.push(['_trackPageview']);
  
        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      };
    </script>

    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/ja_JP/all.js#xfbml=1";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>

    <script src="/assets/javascripts/jquery-1.7.2.min.js"></script>
    <script src="/assets/javascripts/lightbox.js"></script>

    <script type="text/javascript" src="https://gumroad.com/js/gumroad.js"></script>
  </body>
</html>

